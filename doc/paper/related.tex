\section{Related Work} \label{sec:related}
%introduce full virtualization, then move onto PV for performance and finally introduce the security and performance issues.
%VMware~\cite{devine2002virtualization} implements a full virtualization of the underlying computer hardware and allows unmodified guest OSes to execute on a hypervisor, which has degraded the system performance. Denali~\cite{whitaker2002scale} is the first to develop paravirtualization techniques to achieve high performance for modified VMs running network services while Xen~\cite{barham2003xen} is intended to support real operating systems hosting industry standard applications, which makes Xen become popular and widely used in cloud computing. And how to improve its security and performance becomes a major concern.

%talk about how to improve Xen's security.
%Murray \emph{et al.}~\cite{disaggregation} manage to reduce trusted computing base (TCB) of a Xen-based system, which moves the VM-building component from the privileged VM, namely \emph{Domain 0} into a small and trusted compartment.
%Xoar~\cite{colp2011breaking} is proposed to protect Xen hypervisor by breaking the \emph{Domain 0} into several single-purpose components, and each component is configured to expose its dedicated interfaces to VMs and have the least required-privilege access to the hypervisor, also resulting in a reduction of TCB. CloudVisor~\cite{zhang2011cloudvisor} is introduced to prevent leakage of users's data inside a VM by breaking Xen hypervisor into both a resource management module and a nested security monitor and the monitor is responsible for providing protection to the VMs, largely improving Xen's security.

%improve I/O performance for paravirtual I/O method
%As I/O activity is an important performance factor in virtualized environments, the paravirtual I/O method introduced by Xen is efficient to transfer I/O data. Instead of emulating hardware devices, Xen asks the \emph{backend} of a device running in the \emph{driver domain} to communicate with the \emph{frontend} of that device residing in a guest domain by passing the data info through shared-memory, etc. Har'El \emph{et al.}~\cite{har2013efficient} claim to provide a more efficient paravirtual I/O system by combing a fine-grained I/O scheduling and exitless notifications with separate cores, each core dedicated to handling one domain's I/O requests. Besides, to approach bare-metal performance for VMs that interact with I/O devices directly, ELI~\cite{eli} is presented to remove the hypervisor from the I/O interrupt handling path while handle the interrupts within VMs securely.

%talk about IOMMU performance when it is armed by Xen
%As the paravirtual I/O method is not secure enough for DMA access~\cite{disaggregation}, IOMMU (AMD-Vi~\cite{amdvt} or Intel VT-d~\cite{intelvt}) is armed by Xen to prevent buggy device drivers from overwriting system's memory, which subsequently introduces new I/O performance issues. On top of that, Willmann \emph{et al.}~\cite{willmann2008protection} proposes new strategies for Xen to configure IOMMU in order to reduce I/O performance overhead without sacrificing Xen's security. Particularly, Amit \emph{et al.}~\cite{amit2012iommu} and Malka \emph{et al.}~\cite{malka2015riommu} deeply analyze the role of IOMMU's IOTLB in DMA operations and quantifies bottleneck overhead of IOTLB in the high I/O performance environments.

%introduce our work
%In our work, we are focusing on the page table (de)allocations of paravirtual OS. When an OS is ported to Xen, there exists long execution paths of the guest page table (de)allocations and additional IOTLB flushes due to the security validations for page table (de)allocations. Because of the two performance issues, \name is presented to efficiently cut down the execution length and completely eliminate IOTLB flushes, resulting in better performance for both OS and IOMMU.

%Although the hypervisor provides valuable services for memory access from both sides, it is far from enough.
%so as to reduce the performance degradation for the OS inside a VM while prevent illicit access or faults from the OS, achieving a good tradeoff between performance and safety for software access.
%NoHype~\cite{keller2010nohype}
%in its original design, Xen uses an efficient
%Ben-Yehuda~\cite{ben2008xen} talks about the I/O virtualization of Xen by IOMMU~\cite{intelvt,amdvt}, which not only allows direct access to I/O devices by untrusted VMs but prevents buggy device drivers from overwriting system's memory, thereby largely improving the system's availability and reliability for DMA access.

%introduce
%In our work, we focus on the paravirtual page table (de)allocations as well as their impacts on the IOTLB performance. The related work will be introduced from the two aspects as follows.
\mypara{Hypervisor Security by Page Table Configuration} The first category of related work is previous studies in protecting hypervisor by configuring page tables. In paravirtualization where the hypervisor and guest OS are sharing the same virtual space, Xen~\cite{barham2003xen} takes the responsibility of validating every update of guest page tables so as to protect itself from any malicious access. Unfortunately, the protection is not secure enough since the page tables are still \emph{writable}. If a page table entry is modified, the memory protection policy enforced by the page table will be subverted. Because of the security threat, Hypersafe~\cite{wang2010hypersafe} proposes a technique of non-bypassable memory lockdown, which disallows any write attempt to the page tables except benign behaviors conforming to security policy. This key technique further protects the hypervisor's code integrity as well its static data, and it has been applied into Xen.
As a result, they typically focus on how to improve hypervisor security by validating page table updates. \name manages to improve the performance of page table (de)allocations. When an OS is ported to the paravirtual hypervisor, there exists long execution paths of the guest page table (de)allocations, \name is presented to efficiently shorten the execution length.

\mypara{Performance Overhead of IOTLB Misses Reduction} This category is about IOTLB miss reduction. Amit \emph{et al.}~\cite{amit2012iommu} firstly analyze the role of IOMMU's IOTLB in DMA operations and quantifies the performance overhead of IOTLB misses. Then they present new strategies of both software and hardware enhancements to reduce IOTLB miss rate in order to facilitate DMA address resolution. rIOMMU~\cite{malka2015riommu} re-designs the architecture of IOMMU to achieve high performance in DMA transactions, during which the IOTLB misses are also largely reduced. Willmann \emph{et al.}~\cite{willmann2008protection} proposes new strategies for Xen to re-configure the addressing mode of IOMMU, resulting in fewer IOTLB misses.
Since we have observed that the security validations by Xen during guest page table (de)allocations will lead to lots of IOTLB flushes, \name focuses on eliminating the additional IOTLB misses by a find-grained validation scheme.

\mypara{I/O performance improvement} The last category is to improve the performance of I/O virtualization. Generally, I/O virtualization is implemented in two ways, i.e., paravirtual I/O and direct I/O.
%\emph{Paravirtual I/O} 
The paravirtual I/O method introduced by Xen is efficient to transfer I/O data. Instead of emulating hardware devices, Xen asks the \emph{backend} of a device running in the privileged domain to communicate with the \emph{frontend} of that device residing in a guest domain by passing the data information through shared-memory, etc. To further improve the performance, Har'El \emph{et al.}~\cite{har2013efficient} provides a more efficient paravirtual I/O system by combing a fine-grained I/O scheduling and exitless notifications with separate cores, each core dedicated to handling one domain's I/O requests. Unlike running I/O workloads in parallel on a different set of cores, vTurbo~\cite{xu2013vturbo} facilitates I/O processing for virtual machines by offloading the processing to a designated core with a smaller time-slice than usual. The dedicated core will process most I/O requests, hence achieving low I/O latency.

%\emph{Direct I/O}


%With the aid of IOMMU, virtual machines can interact with devices directly and securely (a.k.a., direct assignment), which enhances the I/O performance. But it is not enough, ELI~\cite{eli} is introduced to remove the hypervisor from the I/O interrupt handling path while handle the interrupts within VMs securely, thereby approaching bare-metal I/O performance.
